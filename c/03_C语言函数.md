# C语言函数

本教程将学习C语言中的函数，包括函数定义、调用、参数传递等内容。

## 1. 函数基础

### 函数定义和调用

```c
#include <stdio.h>

// 函数声明
int add(int a, int b);

// 函数定义
int add(int a, int b) {
    return a + b;
}

int main() {
    int result = add(5, 3);
    printf("5 + 3 = %d\n", result);
    
    return 0;
}
```

### 函数的基本结构

```c
返回类型 函数名(参数列表) {
    函数体
    return 返回值;
}
```

## 2. 无返回值函数（void）

```c
#include <stdio.h>

// void函数不返回任何值
void greet(char name[]) {
    printf("Hello, %s!\n", name);
}

void print_line() {
    printf("--------------------------------\n");
}

int main() {
    print_line();
    greet("张三");
    print_line();
    
    return 0;
}
```

## 3. 函数参数

### 值传递

```c
#include <stdio.h>

// 值传递：函数内部修改参数不会影响原变量
void swap(int a, int b) {
    int temp = a;
    a = b;
    b = temp;
    printf("函数内部: a = %d, b = %d\n", a, b);
}

int main() {
    int x = 10, y = 20;
    
    printf("交换前: x = %d, y = %d\n", x, y);
    swap(x, y);
    printf("交换后: x = %d, y = %d\n", x, y);
    // 注意：x和y的值并没有真正交换
    
    return 0;
}
```

### 指针传递（地址传递）

```c
#include <stdio.h>

// 指针传递：可以通过指针修改原变量的值
void swap(int *a, int *b) {
    int temp = *a;
    *a = *b;
    *b = temp;
}

int main() {
    int x = 10, y = 20;
    
    printf("交换前: x = %d, y = %d\n", x, y);
    swap(&x, &y);  // 传递地址
    printf("交换后: x = %d, y = %d\n", x, y);
    // 现在x和y的值真正交换了
    
    return 0;
}
```

## 4. 函数返回值

### 返回单个值

```c
#include <stdio.h>

// 返回最大值
int max(int a, int b) {
    return (a > b) ? a : b;
}

// 返回绝对值
int abs(int x) {
    return (x < 0) ? -x : x;
}

int main() {
    printf("max(10, 20) = %d\n", max(10, 20));
    printf("abs(-5) = %d\n", abs(-5));
    printf("abs(5) = %d\n", abs(5));
    
    return 0;
}
```

### 返回多个值（通过指针）

```c
#include <stdio.h>

// 通过指针参数返回多个值
void calculate(int a, int b, int *sum, int *product) {
    *sum = a + b;
    *product = a * b;
}

int main() {
    int x = 10, y = 20;
    int s, p;
    
    calculate(x, y, &s, &p);
    printf("%d + %d = %d\n", x, y, s);
    printf("%d * %d = %d\n", x, y, p);
    
    return 0;
}
```

## 5. 递归函数

```c
#include <stdio.h>

// 递归计算阶乘
long long factorial(int n) {
    if (n <= 1) {
        return 1;
    }
    return n * factorial(n - 1);
}

// 递归计算斐波那契数列
int fibonacci(int n) {
    if (n <= 1) {
        return n;
    }
    return fibonacci(n - 1) + fibonacci(n - 2);
}

int main() {
    int n = 5;
    printf("%d! = %lld\n", n, factorial(n));
    
    printf("斐波那契数列前10项:\n");
    for (int i = 0; i < 10; i++) {
        printf("%d ", fibonacci(i));
    }
    printf("\n");
    
    return 0;
}
```

## 6. 函数声明和定义

### 函数声明（函数原型）

```c
#include <stdio.h>

// 函数声明（可以在main之前或头文件中）
int add(int a, int b);
void print_info(char name[], int age);

int main() {
    int result = add(5, 3);
    printf("结果: %d\n", result);
    
    print_info("张三", 25);
    
    return 0;
}

// 函数定义可以在main之后
int add(int a, int b) {
    return a + b;
}

void print_info(char name[], int age) {
    printf("姓名: %s, 年龄: %d\n", name, age);
}
```

## 7. 常用数学函数

```c
#include <stdio.h>
#include <math.h>  // 数学函数库

int main() {
    double x = 16.0;
    double y = 2.5;
    
    printf("sqrt(%.2f) = %.2f\n", x, sqrt(x));        // 平方根
    printf("pow(%.2f, 2) = %.2f\n", y, pow(y, 2));    // 幂运算
    printf("ceil(%.2f) = %.2f\n", y, ceil(y));        // 向上取整
    printf("floor(%.2f) = %.2f\n", y, floor(y));      // 向下取整
    printf("fabs(%.2f) = %.2f\n", -y, fabs(-y));      // 绝对值
    printf("sin(%.2f) = %.2f\n", y, sin(y));          // 正弦
    printf("cos(%.2f) = %.2f\n", y, cos(y));          // 余弦
    
    return 0;
}
```

**编译时需要链接数学库：**
```bash
gcc program.c -o program -lm
```

## 8. 函数指针

```c
#include <stdio.h>

int add(int a, int b) {
    return a + b;
}

int multiply(int a, int b) {
    return a * b;
}

int main() {
    // 函数指针声明
    int (*operation)(int, int);
    
    // 指向add函数
    operation = add;
    printf("add(5, 3) = %d\n", operation(5, 3));
    
    // 指向multiply函数
    operation = multiply;
    printf("multiply(5, 3) = %d\n", operation(5, 3));
    
    return 0;
}
```

## 9. 可变参数函数

```c
#include <stdio.h>
#include <stdarg.h>

// 可变参数函数：计算多个整数的和
int sum(int count, ...) {
    va_list args;
    va_start(args, count);
    
    int total = 0;
    for (int i = 0; i < count; i++) {
        total += va_arg(args, int);
    }
    
    va_end(args);
    return total;
}

int main() {
    printf("sum(3, 10, 20, 30) = %d\n", sum(3, 10, 20, 30));
    printf("sum(5, 1, 2, 3, 4, 5) = %d\n", sum(5, 1, 2, 3, 4, 5));
    
    return 0;
}
```

## 10. 综合示例

### 示例1：判断素数函数

```c
#include <stdio.h>
#include <stdbool.h>
#include <math.h>

bool is_prime(int n) {
    if (n <= 1) {
        return false;
    }
    if (n == 2) {
        return true;
    }
    if (n % 2 == 0) {
        return false;
    }
    
    for (int i = 3; i * i <= n; i += 2) {
        if (n % i == 0) {
            return false;
        }
    }
    return true;
}

int main() {
    int num;
    printf("请输入一个正整数: ");
    scanf("%d", &num);
    
    if (is_prime(num)) {
        printf("%d 是素数\n", num);
    } else {
        printf("%d 不是素数\n", num);
    }
    
    return 0;
}
```

### 示例2：计算器函数

```c
#include <stdio.h>

double calculate(char op, double a, double b) {
    switch (op) {
        case '+':
            return a + b;
        case '-':
            return a - b;
        case '*':
            return a * b;
        case '/':
            if (b != 0) {
                return a / b;
            } else {
                printf("错误：除数不能为0\n");
                return 0;
            }
        default:
            printf("错误：无效的运算符\n");
            return 0;
    }
}

int main() {
    double x = 10.0, y = 3.0;
    
    printf("%.2f + %.2f = %.2f\n", x, y, calculate('+', x, y));
    printf("%.2f - %.2f = %.2f\n", x, y, calculate('-', x, y));
    printf("%.2f * %.2f = %.2f\n", x, y, calculate('*', x, y));
    printf("%.2f / %.2f = %.2f\n", x, y, calculate('/', x, y));
    
    return 0;
}
```

## 练习

1. 编写一个函数，判断一个数是否为完全数（所有因子之和等于它本身）
2. 编写一个函数，计算两个数的最大公约数（GCD）
3. 编写一个函数，计算字符串的长度（不使用strlen函数）
4. 编写一个递归函数，计算x的n次方

