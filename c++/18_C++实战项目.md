# C++实战项目

本教程将提供几个完整的C++实战项目，包括学生管理系统、图书馆管理系统等。

## 1. 学生管理系统

```cpp
#include <iostream>
#include <vector>
#include <string>
#include <fstream>
#include <algorithm>
#include <iomanip>
using namespace std;

class Student {
private:
    int id;
    string name;
    int age;
    double score;
    
public:
    Student(int i = 0, string n = "", int a = 0, double s = 0.0)
        : id(i), name(n), age(a), score(s) {}
    
    // Getter方法
    int getId() const { return id; }
    string getName() const { return name; }
    int getAge() const { return age; }
    double getScore() const { return score; }
    
    // Setter方法
    void setId(int i) { id = i; }
    void setName(const string& n) { name = n; }
    void setAge(int a) { age = a; }
    void setScore(double s) { score = s; }
    
    // 显示信息
    void display() const {
        cout << left << setw(10) << id 
             << setw(20) << name
             << setw(10) << age
             << setw(10) << fixed << setprecision(2) << score << endl;
    }
    
    // 用于文件保存
    string toFileString() const {
        return to_string(id) + " " + name + " " 
               + to_string(age) + " " + to_string(score);
    }
    
    // 从文件读取
    static Student fromFileString(const string& line) {
        int id, age;
        string name;
        double score;
        stringstream ss(line);
        ss >> id >> name >> age >> score;
        return Student(id, name, age, score);
    }
};

class StudentManager {
private:
    vector<Student> students;
    string filename;
    
public:
    StudentManager(const string& file = "students.txt") : filename(file) {
        loadFromFile();
    }
    
    ~StudentManager() {
        saveToFile();
    }
    
    // 添加学生
    void addStudent(const Student& student) {
        students.push_back(student);
        cout << "学生添加成功！" << endl;
    }
    
    // 删除学生
    bool deleteStudent(int id) {
        auto it = find_if(students.begin(), students.end(),
                         [id](const Student& s) { return s.getId() == id; });
        if (it != students.end()) {
            students.erase(it);
            cout << "学生删除成功！" << endl;
            return true;
        }
        cout << "未找到ID为 " << id << " 的学生！" << endl;
        return false;
    }
    
    // 查找学生
    Student* findStudent(int id) {
        auto it = find_if(students.begin(), students.end(),
                         [id](const Student& s) { return s.getId() == id; });
        return (it != students.end()) ? &(*it) : nullptr;
    }
    
    // 修改学生信息
    bool updateStudent(int id, const Student& newInfo) {
        Student* student = findStudent(id);
        if (student) {
            *student = newInfo;
            student->setId(id);  // 保持ID不变
            cout << "学生信息更新成功！" << endl;
            return true;
        }
        cout << "未找到ID为 " << id << " 的学生！" << endl;
        return false;
    }
    
    // 显示所有学生
    void displayAll() const {
        if (students.empty()) {
            cout << "暂无学生信息！" << endl;
            return;
        }
        
        cout << left << setw(10) << "ID"
             << setw(20) << "姓名"
             << setw(10) << "年龄"
             << setw(10) << "分数" << endl;
        cout << string(50, '-') << endl;
        
        for (const auto& student : students) {
            student.display();
        }
    }
    
    // 按分数排序
    void sortByScore() {
        sort(students.begin(), students.end(),
             [](const Student& a, const Student& b) {
                 return a.getScore() > b.getScore();
             });
        cout << "按分数排序完成！" << endl;
    }
    
    // 统计
    void statistics() const {
        if (students.empty()) {
            cout << "暂无学生信息！" << endl;
            return;
        }
        
        double total = 0;
        double maxScore = students[0].getScore();
        double minScore = students[0].getScore();
        
        for (const auto& student : students) {
            total += student.getScore();
            maxScore = max(maxScore, student.getScore());
            minScore = min(minScore, student.getScore());
        }
        
        double avg = total / students.size();
        
        cout << "统计信息：" << endl;
        cout << "学生总数: " << students.size() << endl;
        cout << "平均分: " << fixed << setprecision(2) << avg << endl;
        cout << "最高分: " << maxScore << endl;
        cout << "最低分: " << minScore << endl;
    }
    
    // 从文件加载
    void loadFromFile() {
        ifstream infile(filename);
        if (infile.is_open()) {
            students.clear();
            string line;
            while (getline(infile, line)) {
                if (!line.empty()) {
                    students.push_back(Student::fromFileString(line));
                }
            }
            infile.close();
        }
    }
    
    // 保存到文件
    void saveToFile() const {
        ofstream outfile(filename);
        if (outfile.is_open()) {
            for (const auto& student : students) {
                outfile << student.toFileString() << endl;
            }
            outfile.close();
        }
    }
};

// 菜单系统
void showMenu() {
    cout << "\n========== 学生管理系统 ==========" << endl;
    cout << "1. 添加学生" << endl;
    cout << "2. 删除学生" << endl;
    cout << "3. 查找学生" << endl;
    cout << "4. 修改学生信息" << endl;
    cout << "5. 显示所有学生" << endl;
    cout << "6. 按分数排序" << endl;
    cout << "7. 统计信息" << endl;
    cout << "0. 退出" << endl;
    cout << "===================================" << endl;
    cout << "请选择操作: ";
}

int main() {
    StudentManager manager;
    int choice;
    
    while (true) {
        showMenu();
        cin >> choice;
        
        if (choice == 0) {
            cout << "感谢使用！" << endl;
            break;
        }
        
        switch (choice) {
            case 1: {
                int id, age;
                string name;
                double score;
                cout << "请输入学生信息（ID 姓名 年龄 分数）: ";
                cin >> id >> name >> age >> score;
                manager.addStudent(Student(id, name, age, score));
                break;
            }
            case 2: {
                int id;
                cout << "请输入要删除的学生ID: ";
                cin >> id;
                manager.deleteStudent(id);
                break;
            }
            case 3: {
                int id;
                cout << "请输入要查找的学生ID: ";
                cin >> id;
                Student* student = manager.findStudent(id);
                if (student) {
                    cout << left << setw(10) << "ID"
                         << setw(20) << "姓名"
                         << setw(10) << "年龄"
                         << setw(10) << "分数" << endl;
                    student->display();
                } else {
                    cout << "未找到该学生！" << endl;
                }
                break;
            }
            case 4: {
                int id, age;
                string name;
                double score;
                cout << "请输入要修改的学生ID: ";
                cin >> id;
                cout << "请输入新信息（姓名 年龄 分数）: ";
                cin >> name >> age >> score;
                manager.updateStudent(id, Student(id, name, age, score));
                break;
            }
            case 5:
                manager.displayAll();
                break;
            case 6:
                manager.sortByScore();
                manager.displayAll();
                break;
            case 7:
                manager.statistics();
                break;
            default:
                cout << "无效的选择！" << endl;
        }
    }
    
    return 0;
}
```

## 2. 图书馆管理系统（简化版）

```cpp
#include <iostream>
#include <vector>
#include <string>
#include <map>
#include <algorithm>
using namespace std;

class Book {
private:
    int id;
    string title;
    string author;
    bool available;
    
public:
    Book(int i, string t, string a) 
        : id(i), title(t), author(a), available(true) {}
    
    int getId() const { return id; }
    string getTitle() const { return title; }
    string getAuthor() const { return author; }
    bool isAvailable() const { return available; }
    
    void borrow() { available = false; }
    void returnBook() { available = true; }
    
    void display() const {
        cout << "ID: " << id << ", 书名: " << title 
             << ", 作者: " << author 
             << ", 状态: " << (available ? "可借" : "已借出") << endl;
    }
};

class Library {
private:
    map<int, Book> books;
    int nextId = 1;
    
public:
    void addBook(const string& title, const string& author) {
        books[nextId] = Book(nextId, title, author);
        cout << "图书添加成功！ID: " << nextId << endl;
        nextId++;
    }
    
    void borrowBook(int id) {
        auto it = books.find(id);
        if (it != books.end()) {
            if (it->second.isAvailable()) {
                it->second.borrow();
                cout << "借书成功！" << endl;
            } else {
                cout << "该书已被借出！" << endl;
            }
        } else {
            cout << "未找到该书！" << endl;
        }
    }
    
    void returnBook(int id) {
        auto it = books.find(id);
        if (it != books.end()) {
            it->second.returnBook();
            cout << "还书成功！" << endl;
        } else {
            cout << "未找到该书！" << endl;
        }
    }
    
    void displayAll() {
        for (const auto& pair : books) {
            pair.second.display();
        }
    }
    
    void searchByTitle(const string& title) {
        bool found = false;
        for (const auto& pair : books) {
            if (pair.second.getTitle().find(title) != string::npos) {
                pair.second.display();
                found = true;
            }
        }
        if (!found) {
            cout << "未找到相关图书！" << endl;
        }
    }
};

int main() {
    Library library;
    
    // 添加一些示例图书
    library.addBook("C++ Primer", "Stanley Lippman");
    library.addBook("算法导论", "Thomas H. Cormen");
    library.addBook("设计模式", "Gang of Four");
    
    // 显示所有图书
    library.displayAll();
    
    // 借书
    library.borrowBook(1);
    
    // 搜索
    library.searchByTitle("C++");
    
    // 还书
    library.returnBook(1);
    
    return 0;
}
```

## 3. 综合项目框架

### 项目结构示例

```
Project/
├── src/
│   ├── main.cpp
│   ├── Student.cpp
│   ├── StudentManager.cpp
│   └── utils.cpp
├── include/
│   ├── Student.h
│   ├── StudentManager.h
│   └── utils.h
├── CMakeLists.txt
└── README.md
```

### 使用CMake构建

```cmake
# CMakeLists.txt
cmake_minimum_required(VERSION 3.10)
project(StudentManagementSystem)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# 包含目录
include_directories(include)

# 源文件
set(SOURCES
    src/main.cpp
    src/Student.cpp
    src/StudentManager.cpp
)

# 可执行文件
add_executable(${PROJECT_NAME} ${SOURCES})

# 编译选项
target_compile_options(${PROJECT_NAME} PRIVATE -Wall -Wextra)
```

## 练习

1. 完善学生管理系统，添加更多功能（如导入导出Excel）
2. 实现一个完整的图书馆管理系统
3. 创建一个简单的文本编辑器
4. 实现一个计算器程序（支持表达式计算）
5. 开发一个简单的游戏（如贪吃蛇、俄罗斯方块）

